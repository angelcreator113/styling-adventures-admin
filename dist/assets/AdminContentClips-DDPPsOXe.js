import{f as B,r as m,j as t,e as j,c as g,b as l,h as w,d as x,i as C,q as T,a as W,o as q,s as v}from"./index-Dpurs1Jy.js";const n={wrap:{display:"grid",gridTemplateColumns:"240px 260px 1fr",gap:16},col:{background:"#fff",border:"1px solid #eee",borderRadius:12,padding:12,minHeight:420},head:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},h6:{margin:0,fontSize:14,fontWeight:700,color:"#111827"},list:{display:"grid",gap:6},pill:d=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",borderRadius:10,cursor:"pointer",background:d?"#EEF2FF":"#F9FAFB",border:"1px solid #E5E7EB",color:d?"#4338CA":"#111827",fontWeight:d?600:500}),grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px,1fr))",gap:12},card:{border:"1px solid #eee",borderRadius:12,padding:10,background:"#fff"},thumb:{width:"100%",aspectRatio:"1/1",background:"#f8fafc",border:"1px solid #f1f5f9",borderRadius:10,display:"grid",placeItems:"center",fontSize:12,color:"#64748b"},row:{display:"flex",gap:8,alignItems:"center"},btn:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer",fontSize:12},btnP:{padding:"6px 10px",borderRadius:8,border:"1px solid #c4b5fd",background:"#ede9fe",color:"#6d28d9",cursor:"pointer",fontSize:12,fontWeight:600},input:{width:"100%",padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff"},empty:{padding:"12px",border:"1px dashed #e5e7eb",borderRadius:12,color:"#6b7280",textAlign:"center"},tiny:{fontSize:12,color:"#6b7280"}};function k(d,o){const{order:i="createdAt"}={},[h,s]=m.useState([]);return m.useEffect(()=>{if(!d){s([]);return}const a=T(g(l,d),W(i,"asc"));return q(a,y=>{s(y.docs.map(c=>({id:c.id,...c.data()})))})},[d,i]),h}function M(){const o=B.currentUser?.uid,[i,h]=m.useState(null),[s,a]=m.useState(null),b=o?`users/${o}/files`:null,y=o&&i?`users/${o}/files/${i}/folders`:null,c=o&&i&&s?`users/${o}/files/${i}/folders/${s}/items`:null,u=k(b),p=k(y),$=k(c);if(m.useEffect(()=>{u.length&&!i&&h(u[0].id),u.length||(h(null),a(null))},[u,i]),m.useEffect(()=>{p.length&&!s&&a(p[0].id),p.length||a(null)},[p,s]),!o)return t.jsx("div",{style:n.empty,children:"Please sign in to use Creator Files."});async function R(){const e=prompt("New category name?");e&&await j(g(l,b),{name:e.trim(),createdAt:v()})}async function I(e,r){const f=prompt("Rename category:",r||"");f&&await w(x(l,`${b}/${e}`),{name:f.trim()})}async function F(e){confirm("Delete this category (and its folders/items)? This cannot be undone.")&&(await C(x(l,`${b}/${e}`)),i===e&&(h(null),a(null)))}async function P(){if(!i)return;const e=prompt("New subfolder name?");e&&await j(g(l,y),{name:e.trim(),createdAt:v()})}async function S(e,r){const f=prompt("Rename folder:",r||"");f&&await w(x(l,`${y}/${e}`),{name:f.trim()})}async function N(e){confirm("Delete this folder (and its items)?")&&(await C(x(l,`${y}/${e}`)),s===e&&a(null))}async function D(){if(!c)return;const e=prompt("Item title?");e&&await j(g(l,c),{title:e.trim(),createdAt:v(),previewUrl:"",fileUrl:""})}async function E(e,r){const f=prompt("Rename item:",r||"");f&&await w(x(l,`${c}/${e}`),{title:f.trim()})}async function A(e){confirm("Delete this item?")&&await C(x(l,`${c}/${e}`))}const U=m.useMemo(()=>u.find(e=>e.id===i)?.name||"—",[u,i]),z=m.useMemo(()=>p.find(e=>e.id===s)?.name||"—",[p,s]);return t.jsxs("div",{style:n.wrap,children:[t.jsxs("div",{style:n.col,children:[t.jsxs("div",{style:n.head,children:[t.jsx("h6",{style:n.h6,children:"Categories"}),t.jsx("button",{style:n.btnP,onClick:R,children:"+ New"})]}),t.jsxs("div",{style:n.list,children:[u.map(e=>t.jsxs("div",{style:n.pill(e.id===i),onClick:()=>h(e.id),children:[t.jsx("span",{children:e.name||"Untitled"}),t.jsxs("span",{style:n.row,children:[t.jsx("button",{title:"Rename",style:n.btn,onClick:r=>{r.stopPropagation(),I(e.id,e.name)},children:"✏️"}),t.jsx("button",{title:"Delete",style:n.btn,onClick:r=>{r.stopPropagation(),F(e.id)},children:"🗑️"})]})]},e.id)),!u.length&&t.jsx("div",{style:n.empty,children:"No categories yet."})]})]}),t.jsxs("div",{style:n.col,children:[t.jsxs("div",{style:n.head,children:[t.jsxs("h6",{style:n.h6,children:["Subfolders ",i?t.jsxs("span",{style:n.tiny,children:["in “",U,"”"]}):null]}),t.jsx("button",{style:n.btnP,onClick:P,disabled:!i,children:"+ New"})]}),t.jsxs("div",{style:n.list,children:[p.map(e=>t.jsxs("div",{style:n.pill(e.id===s),onClick:()=>a(e.id),children:[t.jsx("span",{children:e.name||"Untitled"}),t.jsxs("span",{style:n.row,children:[t.jsx("button",{title:"Rename",style:n.btn,onClick:r=>{r.stopPropagation(),S(e.id,e.name)},children:"✏️"}),t.jsx("button",{title:"Delete",style:n.btn,onClick:r=>{r.stopPropagation(),N(e.id)},children:"🗑️"})]})]},e.id)),!p.length&&t.jsx("div",{style:n.empty,children:"No subfolders yet."})]})]}),t.jsxs("div",{style:n.col,children:[t.jsxs("div",{style:n.head,children:[t.jsxs("h6",{style:n.h6,children:["Items ",s?t.jsxs("span",{style:n.tiny,children:["in “",z,"”"]}):null]}),t.jsx("div",{style:n.row,children:t.jsx("button",{style:n.btnP,onClick:D,disabled:!s,children:"+ New Item"})})]}),s?$.length?t.jsx("div",{style:n.grid,children:$.map(e=>t.jsxs("article",{style:n.card,children:[t.jsx("div",{style:n.thumb,children:e.previewUrl?t.jsx("img",{src:e.previewUrl,alt:"",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:10}}):"No preview"}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[t.jsx("div",{style:{fontSize:13,fontWeight:600},children:e.title||"Untitled"}),t.jsxs("div",{style:n.row,children:[t.jsx("button",{title:"Rename",style:n.btn,onClick:()=>E(e.id,e.title),children:"✏️"}),t.jsx("button",{title:"Delete",style:n.btn,onClick:()=>A(e.id),children:"🗑️"})]})]})]},e.id))}):t.jsx("div",{style:n.empty,children:"No items in this folder yet."}):t.jsx("div",{style:n.empty,children:"Choose a subfolder to see items."})]})]})}function G(){return t.jsx(M,{scope:"admin",fixedCategory:null,title:"Admin Content — Clips"})}export{G as default};
