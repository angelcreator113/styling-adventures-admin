import{a5 as o,r as i,x as C,j as t,a as V,q as S,a6 as w,b as r,l as M,a7 as B,m as H,w as A,d as c,h as I,s as h,i as Q}from"./index-Dpurs1Jy.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],Z=o("archive-restore",W);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],K=o("archive",J);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],X=o("search",O);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ee=o("trash-2",Y);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ae=o("users",te),D=24;function ie(){const[p,T]=i.useState(""),[n,_]=i.useState("all"),[m,d]=i.useState([]),[u,E]=i.useState(null),[f,j]=i.useState(!1),[b,L]=i.useState(""),[v,U]=i.useState(""),[k,$]=i.useState(""),N=i.useMemo(()=>n==="active"?C("status","==","active"):n==="archived"?C("status","==","archived"):null,[n]);async function x(e=!1){j(!0);try{const a=[V("updatedAt","desc")];N&&a.unshift(N);let s=S(w(r,"spaces"),...a,M(D));e&&u&&(s=S(w(r,"spaces"),...a,B(u),M(D)));const y=await H(s),g=[];y.forEach(l=>g.push({id:l.id,path:l.ref.path,...l.data()})),d(l=>e?[...l,...g]:g),E(y.docs[y.docs.length-1]||null)}finally{j(!1)}}i.useEffect(()=>{x(!1)},[n]);const G=i.useMemo(()=>{const e=p.trim().toLowerCase();return e?m.filter(a=>`${a.name||""} ${a.uid||""} ${a.spaceId||""}`.toLowerCase().includes(e)):m},[p,m]);async function q(){const e=parseInt(b,10);if(!Number.isFinite(e)||e<0)return alert("Enter a valid number");await A(c(r,"app_settings","spaces"),{maxSpacesGlobal:e,updatedAt:h()},{merge:!0}),alert("Global limit saved")}async function z(){const e=parseInt(k,10);if(!v)return alert("Enter a creator UID");if(!Number.isFinite(e)||e<0)return alert("Enter a valid number");await A(c(r,`users/${v}/settings/limits`),{maxSpaces:e,updatedAt:h()},{merge:!0}),alert("Per-user limit saved")}async function R(e){await I(c(r,e.path),{status:"archived",updatedAt:h()}),d(a=>a.map(s=>s.path===e.path?{...s,status:"archived"}:s))}async function F(e){await I(c(r,e.path),{status:"active",updatedAt:h()}),d(a=>a.map(s=>s.path===e.path?{...s,status:"active"}:s))}async function P(e){confirm("Delete this space? This cannot be undone.")&&(await Q(c(r,e.path)),d(a=>a.filter(s=>s.path!==e.path)))}return t.jsxs("section",{className:"container",style:{padding:16},children:[t.jsx("h1",{className:"page-title",style:{marginTop:0},children:"Admin — Spaces"}),t.jsxs("div",{className:"dashboard-card",style:{display:"grid",gap:12,gridTemplateColumns:"1fr auto auto"},children:[t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[t.jsx(X,{size:16}),t.jsx("input",{className:"input",placeholder:"Search by name or creator UID…",value:p,onChange:e=>T(e.target.value),style:{width:"100%"}})]}),t.jsxs("select",{className:"select",value:n,onChange:e=>_(e.target.value),children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"active",children:"Active"}),t.jsx("option",{value:"archived",children:"Archived"})]}),t.jsx("button",{className:"btn",onClick:()=>x(!1),disabled:f,children:"Refresh"})]}),t.jsxs("div",{className:"dashboard-card",style:{display:"grid",gap:12,gridTemplateColumns:"1fr 1fr auto 1fr 1fr auto"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[t.jsx(ae,{size:16}),t.jsx("strong",{children:"Global spaces limit"})]}),t.jsx("input",{className:"input",placeholder:"e.g. 10",value:b,onChange:e=>L(e.target.value)}),t.jsx("button",{className:"btn",onClick:q,children:"Save"}),t.jsx("input",{className:"input",placeholder:"Creator UID",value:v,onChange:e=>U(e.target.value)}),t.jsx("input",{className:"input",placeholder:"e.g. 5",value:k,onChange:e=>$(e.target.value)}),t.jsx("button",{className:"btn",onClick:z,children:"Save"})]}),t.jsxs("div",{className:"dashboard-card",style:{marginTop:12},children:[t.jsx("div",{style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))"},children:G.map(e=>t.jsxs("article",{className:"card",style:{padding:12,borderRadius:12,border:"1px solid #eee"},children:[t.jsx("div",{style:{fontWeight:600,marginBottom:4},children:e.name||e.spaceId||"Untitled space"}),t.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[t.jsxs("div",{children:["Creator: ",e.uid||"(unknown)"]}),t.jsxs("div",{children:["Space ID: ",e.spaceId||"(—)"," "]}),t.jsxs("div",{children:["Status: ",e.status||"active"]})]}),t.jsxs("div",{style:{display:"flex",gap:8,marginTop:10},children:[t.jsxs("button",{className:"btn",onClick:()=>R(e),title:"Archive",children:[t.jsx(K,{size:16})," Archive"]}),t.jsxs("button",{className:"btn",onClick:()=>F(e),title:"Restore",children:[t.jsx(Z,{size:16})," Restore"]}),t.jsxs("button",{className:"btn btn-danger",onClick:()=>P(e),title:"Delete",children:[t.jsx(ee,{size:16})," Delete"]})]})]},e.path))}),t.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:16},children:t.jsx("button",{className:"btn",onClick:()=>x(!0),disabled:f||!u,children:u?"Load more":"No more results"})})]})]})}export{ie as default};
