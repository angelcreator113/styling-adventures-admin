import{f as w,r as m,j as t,h as A,i as S,e as b,c as g,b as d,d as k,q as D,a as R,o as q,n as E,p as L,t as P,v as F,s as u}from"./index-Dpurs1Jy.js";function y(i,n=null,o="asc"){const[h,a]=m.useState([]);return m.useEffect(()=>{const c=n?D(g(d,i),R(n,o)):g(d,i),s=q(c,p=>a(p.docs.map(r=>({id:r.id,...r.data()}))));return()=>s()},[i,n,o]),h}async function N(i){const n=`images/public/${Date.now()}-${i.name}`,o=E(L,n);return await P(o,i,{contentType:i.type}),await F(o)}function _(){const i=w.currentUser?.uid,n=y("public/top_picks/items","rank","asc"),o=y("public/spotlights","featuredAt","desc"),h=y("forum/threads","lastActivityAt","desc"),[a,c]=m.useState({title:"",note:"",rank:1,imageUrl:""}),[s,p]=m.useState({userName:"",quote:"",imageUrl:""}),[r,x]=m.useState({title:"",excerpt:""});async function C(e){e.preventDefault();const l=e.target.elements.tpfile.files?.[0],j=l?await N(l):a.imageUrl||"";await b(g(d,"public/top_picks/items"),{...a,rank:Number(a.rank)||1,imageUrl:j,createdAt:u(),updatedAt:u()}),c({title:"",note:"",rank:1,imageUrl:""}),e.target.reset()}async function T(e){e.preventDefault();const l=e.target.elements.spfile.files?.[0],j=l?await N(l):s.imageUrl||"";await b(g(d,"public/spotlights"),{...s,imageUrl:j,featuredAt:u(),createdBy:i||null}),p({userName:"",quote:"",imageUrl:""}),e.target.reset()}async function U(e){e.preventDefault(),await b(g(d,"forum/threads"),{...r,replyCount:0,createdAt:u(),lastActivityAt:u()}),x({title:"",excerpt:""})}const f=(e,l)=>S(k(d,e,l)),v=(e,l)=>A(k(d,"public/top_picks/items",e.id),{rank:Math.max(1,(Number(e.rank)||1)+l)});return t.jsx("section",{className:"container",style:{padding:16},children:t.jsxs("div",{className:"dashboard-card",style:{padding:16},children:[t.jsx("h1",{style:{marginTop:0},children:"Content Editor"}),t.jsx("p",{children:"Admin tools to manage public content on the Home page."}),t.jsx("h2",{children:"Top Picks"}),t.jsxs("form",{onSubmit:C,className:"grid",style:{gap:8,gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))"},children:[t.jsx("input",{placeholder:"Title",value:a.title,onChange:e=>c({...a,title:e.target.value}),required:!0}),t.jsx("input",{placeholder:"Note",value:a.note,onChange:e=>c({...a,note:e.target.value})}),t.jsx("input",{placeholder:"Rank",type:"number",min:"1",value:a.rank,onChange:e=>c({...a,rank:e.target.value})}),t.jsx("input",{placeholder:"Image URL (optional)",value:a.imageUrl,onChange:e=>c({...a,imageUrl:e.target.value})}),t.jsx("input",{name:"tpfile",type:"file",accept:"image/*"}),t.jsx("button",{className:"btn primary",type:"submit",children:"Add Top Pick"})]}),t.jsx("div",{className:"cards",style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fill, minmax(240px,1fr))",marginTop:12},children:n.map(e=>t.jsxs("article",{className:"dashboard-card",style:{padding:8},children:[t.jsx("div",{style:{aspectRatio:"3/4",background:"#fafafa",border:"1px solid #eee",borderRadius:8,overflow:"hidden"},children:e.imageUrl?t.jsx("img",{src:e.imageUrl,alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}}):null}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:6},children:[t.jsx("strong",{children:e.title}),t.jsxs("code",{children:["#",e.rank]})]}),t.jsxs("div",{className:"row",style:{display:"flex",gap:6,marginTop:6},children:[t.jsx("button",{className:"btn sm",onClick:()=>v(e,-1),children:"↑"}),t.jsx("button",{className:"btn sm",onClick:()=>v(e,1),children:"↓"}),t.jsx("button",{className:"btn sm danger",onClick:()=>f("public/top_picks/items",e.id),children:"Delete"})]})]},e.id))}),t.jsx("hr",{style:{margin:"20px 0"}}),t.jsx("h2",{children:"Fan Spotlights"}),t.jsxs("form",{onSubmit:T,className:"grid",style:{gap:8,gridTemplateColumns:"repeat(auto-fit, minmax(220px,1fr))"},children:[t.jsx("input",{placeholder:"Username",value:s.userName,onChange:e=>p({...s,userName:e.target.value}),required:!0}),t.jsx("input",{placeholder:"Quote",value:s.quote,onChange:e=>p({...s,quote:e.target.value})}),t.jsx("input",{placeholder:"Image URL (optional)",value:s.imageUrl,onChange:e=>p({...s,imageUrl:e.target.value})}),t.jsx("input",{name:"spfile",type:"file",accept:"image/*"}),t.jsx("button",{className:"btn primary",type:"submit",children:"Add Spotlight"})]}),t.jsx("div",{className:"cards",style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fill, minmax(260px,1fr))",marginTop:12},children:o.map(e=>t.jsxs("article",{className:"dashboard-card",style:{padding:8},children:[t.jsx("div",{style:{aspectRatio:"16/10",background:"#fafafa",border:"1px solid #eee",borderRadius:8,overflow:"hidden"},children:e.imageUrl?t.jsx("img",{src:e.imageUrl,alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}}):null}),t.jsx("div",{style:{marginTop:6},children:t.jsx("strong",{children:e.userName})}),t.jsx("div",{style:{fontStyle:"italic",color:"#6b7280"},children:e.quote}),t.jsx("button",{className:"btn sm danger",style:{marginTop:6},onClick:()=>f("public/spotlights",e.id),children:"Delete"})]},e.id))}),t.jsx("hr",{style:{margin:"20px 0"}}),t.jsx("h2",{children:"Forum Threads"}),t.jsxs("form",{onSubmit:U,className:"grid",style:{gap:8,gridTemplateColumns:"repeat(auto-fit, minmax(260px,1fr))"},children:[t.jsx("input",{placeholder:"Title",value:r.title,onChange:e=>x({...r,title:e.target.value}),required:!0}),t.jsx("input",{placeholder:"Excerpt",value:r.excerpt,onChange:e=>x({...r,excerpt:e.target.value})}),t.jsx("button",{className:"btn primary",type:"submit",children:"Create Thread"})]}),t.jsx("ul",{style:{marginTop:12,paddingLeft:16},children:h.map(e=>t.jsxs("li",{style:{marginBottom:8},children:[t.jsx("strong",{children:e.title})," — ",t.jsx("span",{style:{color:"#6b7280"},children:e.excerpt}),t.jsx("button",{className:"btn sm danger",style:{marginLeft:8},onClick:()=>f("forum/threads",e.id),children:"Delete"})]},e.id))})]})})}export{_ as default};
