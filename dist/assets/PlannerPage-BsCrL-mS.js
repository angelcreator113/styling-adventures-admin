import{f as b,r as p,c as D,q as f,a as E,o as T,j as t,h as C,i as S,b as m,e as $,d as j,s as y}from"./index-Dpurs1Jy.js";function N(a=""){return a.replace(/([,;])/g,"\\$1").replace(/\n/g,"\\n")}function R({title:a,notes:l,eventDate:h,status:s}){const n=new Date(h),c=i=>String(i).padStart(2,"0"),o=n.getUTCFullYear(),v=c(n.getUTCMonth()+1),g=c(n.getUTCDate()),r=`${o}${v}${g}T090000Z`;return["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Digital Closet//Planner//EN","BEGIN:VEVENT",`UID:${`${Date.now()}@digital-closet`}`,`DTSTAMP:${r}`,`DTSTART:${r}`,`SUMMARY:${N(a||"Outfit Event")}`,l?`DESCRIPTION:${N(l)}`:"",s?`STATUS:${s==="ready"?"CONFIRMED":"TENTATIVE"}`:"","END:VEVENT","END:VCALENDAR"].filter(Boolean).join(`\r
`)}function I(){const a=b.currentUser?.uid,[l,h]=p.useState([]),[s,n]=p.useState({title:"",eventDate:"",vibe:"",notes:"",status:"shopping",remindDays:3});p.useEffect(()=>{if(!a)return;const e=D(m,`users/${a}/planner_events`),i=f(e,E("eventDate","desc")),u=T(i,d=>h(d.docs.map(x=>({id:x.id,...x.data()}))));return()=>u()},[a]);async function c(e){e.preventDefault(),!(!s.title||!s.eventDate)&&(await $(D(m,`users/${a}/planner_events`),{...s,uid:a,createdAt:y(),updatedAt:y()}),n({title:"",eventDate:"",vibe:"",notes:"",status:"shopping",remindDays:3}))}const o=(e,i)=>C(j(m,`users/${a}/planner_events/${e.id}`),{status:i,updatedAt:y()}),v=e=>S(j(m,`users/${a}/planner_events/${e.id}`)),g=e=>{const i=R(e),u=URL.createObjectURL(new Blob([i],{type:"text/calendar"})),d=document.createElement("a");d.href=u,d.download=`${e.title||"outfit-event"}.ics`,d.click(),URL.revokeObjectURL(u)},r=p.useMemo(()=>[...l].sort((e,i)=>(e.eventDate||"")<(i.eventDate||"")?1:-1),[l]);return t.jsx("section",{className:"container",style:{padding:16},children:t.jsxs("div",{className:"dashboard-card",style:{padding:16},children:[t.jsx("h1",{style:{marginTop:0},children:"Event Outfit Planner"}),t.jsxs("form",{onSubmit:c,className:"grid",style:{gap:8,gridTemplateColumns:"repeat(auto-fit, minmax(240px,1fr))"},children:[t.jsx("input",{placeholder:"Event title",value:s.title,onChange:e=>n({...s,title:e.target.value}),required:!0}),t.jsx("input",{type:"date",value:s.eventDate,onChange:e=>n({...s,eventDate:e.target.value}),required:!0}),t.jsx("input",{placeholder:"Vibe (e.g., chic, streetâ€¦)",value:s.vibe,onChange:e=>n({...s,vibe:e.target.value})}),t.jsxs("select",{value:s.status,onChange:e=>n({...s,status:e.target.value}),children:[t.jsx("option",{value:"shopping",children:"ðŸ› still shopping"}),t.jsx("option",{value:"ready",children:"âœ… outfit ready"})]}),t.jsx("input",{type:"number",min:"0",placeholder:"Remind (days before)",value:s.remindDays,onChange:e=>n({...s,remindDays:Number(e.target.value||0)})}),t.jsx("input",{placeholder:"Notes (optional)",value:s.notes,onChange:e=>n({...s,notes:e.target.value})}),t.jsx("button",{className:"btn primary",type:"submit",children:"Save Event"})]}),t.jsx("h2",{style:{marginTop:16},children:"My Events"}),t.jsxs("div",{className:"cards",style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fill, minmax(260px,1fr))"},children:[r.map(e=>t.jsxs("article",{className:"dashboard-card",style:{padding:12},children:[t.jsx("div",{style:{fontWeight:600},children:e.title}),t.jsx("div",{className:"muted",children:e.eventDate}),t.jsxs("div",{style:{marginTop:4},children:[e.vibe?t.jsxs("span",{className:"chip",children:["Vibe: ",e.vibe]}):null," ",t.jsx("span",{className:"chip",children:e.status==="ready"?"âœ… Ready":"ðŸ› Shopping"})," ",Number.isFinite(e.remindDays)?t.jsxs("span",{className:"chip",children:[e.remindDays,"d reminder"]}):null]}),e.notes?t.jsx("p",{style:{marginTop:6},children:e.notes}):null,t.jsxs("div",{className:"row",style:{display:"flex",gap:6,marginTop:6},children:[t.jsx("button",{className:"btn sm",onClick:()=>g(e),children:"Add to Calendar (.ics)"}),e.status!=="ready"?t.jsx("button",{className:"btn sm",onClick:()=>o(e,"ready"),children:"Mark Ready"}):t.jsx("button",{className:"btn sm",onClick:()=>o(e,"shopping"),children:"Mark Shopping"}),t.jsx("button",{className:"btn sm danger",onClick:()=>v(e),children:"Delete"})]})]},e.id)),r.length===0&&t.jsx("p",{className:"muted",children:"No events yet â€” add your first!"})]})]})})}export{I as default};
